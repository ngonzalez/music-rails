- content_for :head do
  = javascript_include_tag :music

= stylesheet_link_tag :music

- if @release.all?{|track| track["format_name"] == "FLAC" }
  = javascript_include_tag :aurora
  = javascript_include_tag :flac

.row
  %ul
    %li
      = link_to search_music_index_path(params.slice("q", "rows")), { "data-transition" => "none" } do
        %i.fa.fa-list.fa-4

- if @images.any?
  .row.margin-20
    .polaroid-images.margin-20
      - @images.each do |image|
        = link_to image.file.url, class: "swipebox" do
          = image_tag image.file.thumb("300x250>").url

- if @nfo.any?
  .row
    %ul
      - @nfo.each do |nfo|
        %li
          = link_to nfo.file.url, target: "_blank" do
            %i.fa.fa-sticky-note.fa-4.shadow-light.margin-10

- @release.each do |infos|
  .row
    %ul
      - infos.slice("artist", "title", "album", "genre", "year", "length").each do |k, v|
        %li
          .col-md-1
            - if ["artist", "year"].include?(k)
              = link_to highlight(v, search_terms_array),                                            |
                  search_music_index_path(rows: search_rows, q: v), { "data-transition" => "none" }  |
            - elsif ["length"].include?(k)
              .badge= Time.at(v).utc.strftime(v.to_i > 3600 ? "%H:%M:%S" : "%M:%S")
            - else
              = highlight(v, search_terms_array)

      %li
        .col-md-2
          %i.fa.fa-play-circle.fa-4.play-btn{ "data-uri" => asset_path(infos["path"]), "data-length" => infos["length"] }

:javascript
  $(document).ready(function(e) {
    observe_btn();
    $('.swipebox').swipebox();
    $.each($('.polaroid-images a'), function(i, element) {
      var i = parseInt(Math.random() * 10);
      var m = Math.random() < 0.5 ? -0.5 : 0.5;
      $(element).css('transform', 'rotate(' + i * m + 'deg)');
    });
  });
